# Лабораторная работа 2

**Дисциплина:** "Системы ввода/вывода"

**Период:** весна 2021

**Выполнили:**
* Анищенко Анатолий, P33113
* Федоров Сергей, P33113

**Название:** "Разработка драйверов блочных устройств"

**Цель работы:** Получить знания и навыки разработки драйверов блочных устройств для операционной системы Linux.

**Вариант:** 2

## Описание функциональности драйвера

Драйвер блочного устройства должен создавать следующие разделы:
- Два первичных раздела размером 10Мбайт каждый 
- Один расширенный раздел, содержащий два логических раздела  размером по 10Мбайт каждый.

Провести форматирование разделов диска с помощью утилиты  `mkfs.vfat`. 

Измерить скорость передачи данных при копировании файлов между  разделами созданного виртуального диска. 

Измерить скорость передачи данных при копировании файлов между  разделами виртуального и реального жестких дисков.

## Структура виртуального диска по варианту

```
Disk structure
All values count of sectors.
+-----------------------+-----------------------+--------+--------+
|    Top-level content  |         Content       |  Start | Length |
+-----------------------+-----------------------+--------+--------+
|          MBR          |          MBR          | 0      | 1      |
+-----------------------+-----------------------+--------+--------+
| Privary volume 10 MiB | Privary volume 10 MiB | 1      | 0x5000 |
+-----------------------+-----------------------+--------+--------+
| Privary volume 20 MiB | Privary volume 20 MiB | 0x5001 | 0xA000 |
+-----------------------+-----------------------+--------+--------+
|                       |          EBR 1        | 0xF001 | 1      |
|                       +-----------------------+--------+--------+ 
|    Extended volume    | Logical volume 10 MiB | 0xF002 | 0x5000 |
|         20 MiB        +-----------------------+--------+--------+
|                       |          EBR 2        | 0x14002| 1      |
|                       +-----------------------+--------+--------+
|                       | Logical volume 10 MiB | 0x14003| 0x5000 |
+-----------------------+-----------------------+--------+--------+
```

## Инструкция по сборке

*Системные требование:* Linux Kernel=4.15.0

Сборка драйвера:

```bash
make
```

Собирается и создается файл драйвера `main.ko`

Установка драйвера в систему Linux

```bash
make do
```

Удаление драйвера из систему Linux

```bash
make rm
```

Чистка директории от файлов сборки

```bash
make clean
```

## Инструкция пользователя

1. Собрать модуль, инструкция см. выше
2. Установить модуль в систему, см. выше
3. Произвести замеры при помощи скрипта *benchmark.sh*

## Примеры использования

