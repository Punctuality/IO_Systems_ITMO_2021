# Лабораторная работы #1

**Дисциплина:** "Системы ввода/вывода"

**Период:** весна 2021

**Название:** "Разработка драйверов символьных устройств"

**Цель работы:** получить знания и навыки разработки драйверов символьных устройств для операционной системы Linux.

## Описание функциональности драйвера

### Требования

Драйвер символьного устройства, должен удовлетворять требованиям:
1. Драйвер должен создавать символьное устройство /dev/var2
2. Драйвер должен создавать интерфейс для получения сведений о результатах операций над созданным в п.1 символьным устройством: файл /proc/var2

### Описания работы драйвера

При записи в файл символьного устройства текста типа “5+6” должен запоминаться результат операции, то есть 11 для данного примера. Должны поддерживаться операции сложения, вычитания, умножения и деления. Последовательность полученных результатов с момента загрузки модуля ядра должна выводиться при чтении созданного файла /proc/var2 в консоль пользователя.

При чтении из файла символьного устройства в кольцевой буфер ядра должен осуществляться вывод тех же данных, которые выводятся при чтении файла /proc/var2.


## Инструкция по сборке

! Используется Linux Kernel - 4.15.0

Сборка драйвера:

```bash
sudo make build
```

Собирается и создается файл драйвера `drv_module.ko`

Установка драйвера в систему Linux

```bash
make install
```

Удаление драйвера из систему Linux

```bash
make uninstall
```

Чистка директории от файлов сборки

```bash
make clean
```

Для упрощения работы были реализованны следующие методы:
```bash
make all
```
Который включает в себя методы `build` и `install`

```bash
make recompile
```
Который включает в себя методы `uninstall`, `clean`, `build` и `install` в соответствующем порядке. Данный метод удобен для повторной загрузке модуля в ядро системы.


## Инструкция пользователя
Модулю реализует подсчет введённых в символьное устройство алгебраических выражений следующего типа `r'\d+(\+|\-|\\|\*)\d+'`.

Чтобы подсчитать выражение, надо в `/dev/var2` записать это самое выражение. Например:
```bash
echo "5+6" > /dev/var2
```

Результат всех операций записан в `/proc/var2`. Прочитать результат: 
```bash
cat /proc/var2
```

Если при записи в /dev/var2 возникает ошибка __Permission denied__ выполнить:
```bash
chmod 777 /dev/var2
```

## Примеры использования

...
